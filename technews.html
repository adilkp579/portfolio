<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TechStream — Modern Tech News</title>
  <meta name="description" content="A fast, modern, and responsive tech news page with dark mode, search, filters, and infinite scrolling." />
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#0b1020">
  
  <!-- Tailwind CSS CDN (standalone) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Tailwind Config: fonts + container + dark mode class
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'ui-sans-serif', 'system-ui', 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', 'Apple Color Emoji', 'Segoe UI Emoji'],
          },
          colors: {
            brand: {
              50: '#eef5ff', 100: '#d9e8ff', 200: '#accaff', 300: '#7facff', 400: '#4f91ff', 500: '#2d74ff', 600: '#1c58db', 700: '#1747af', 800: '#133a8b', 900: '#112f71'
            },
          },
          boxShadow: {
            soft: '0 10px 30px rgba(2,6,23,0.06)'
          }
        }
      }
    }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-fD9qY..." crossorigin="anonymous" referrerpolicy="no-referrer" />

  <style>
    /* Smooth cards + line clamp utility for Tailwind CDN */
    .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
    .line-clamp-3 { display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
    .glass { backdrop-filter: saturate(120%) blur(10px); background: linear-gradient(180deg, rgba(255,255,255,.7), rgba(255,255,255,.55)); }
    .dark .glass { background: linear-gradient(180deg, rgba(17,24,39,.75), rgba(17,24,39,.6)); }
    .sr-only-focusable:focus { position: static; width: auto; height: auto; clip: auto; }
  </style>
</head>
<body class="min-h-screen bg-slate-50 text-slate-800 dark:bg-slate-900 dark:text-slate-100 font-sans">
  <!-- Skip link -->
  <a href="#content" class="sr-only sr-only-focusable absolute left-2 top-2 z-50 rounded bg-brand-600 px-3 py-2 text-white">Skip to content</a>

  <!-- Top ticker -->
  <div id="ticker" class="sticky top-0 z-40 border-b border-slate-200 bg-white/80 dark:border-slate-800 dark:bg-slate-900/70 glass">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 flex items-center gap-3 py-2 text-sm">
      <span class="inline-flex items-center gap-2 font-semibold text-brand-700 dark:text-brand-300"><i class="fa-solid fa-bolt"></i> Trending</span>
      <div class="relative flex-1 overflow-hidden">
        <div id="ticker-track" class="whitespace-nowrap will-change-transform"></div>
      </div>
      <button id="themeToggle" class="rounded-lg px-3 py-1.5 text-sm bg-slate-100 hover:bg-slate-200 dark:bg-slate-800 dark:hover:bg-slate-700" aria-label="Toggle dark mode">
        <i class="fa-solid fa-moon"></i>
      </button>
    </div>
  </div>

  <!-- Header -->
  <header class="bg-gradient-to-b from-white/80 to-transparent dark:from-slate-900/80 sticky top-[40px] z-30 backdrop-blur">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="h-10 w-10 rounded-xl bg-brand-600 text-white grid place-items-center shadow-soft"><i class="fa-solid fa-radar"></i></div>
        <div>
          <h1 class="text-2xl font-extrabold tracking-tight">TechStream</h1>
          <p class="text-xs text-slate-500 dark:text-slate-400">Fast. Focused. Future-ready.</p>
        </div>
      </div>
      <nav class="hidden md:flex items-center gap-6 text-sm">
        <a class="hover:text-brand-600" href="#/latest" data-route="latest">Latest</a>
        <a class="hover:text-brand-600" href="#/ai" data-route="ai">AI</a>
        <a class="hover:text-brand-600" href="#/mobile" data-route="mobile">Mobile</a>
        <a class="hover:text-brand-600" href="#/security" data-route="security">Security</a>
        <a class="hover:text-brand-600" href="#/reviews" data-route="reviews">Reviews</a>
      </nav>
      <div class="flex items-center gap-3">
        <div class="relative hidden sm:block">
          <input id="searchInput" type="search" placeholder="Search news, topics…" class="peer w-64 rounded-xl border border-slate-200 bg-white/70 py-2 pl-9 pr-3 text-sm outline-none placeholder:text-slate-400 focus:border-brand-500 focus:ring-2 focus:ring-brand-500/30 dark:border-slate-700 dark:bg-slate-800" />
          <i class="fa-solid fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 peer-focus:text-brand-500"></i>
        </div>
        <button id="mobileMenuBtn" class="md:hidden rounded-xl border border-slate-200 bg-white/70 px-3 py-2 text-sm dark:border-slate-700 dark:bg-slate-800" aria-expanded="false" aria-controls="mobileMenu"><i class="fa-solid fa-bars"></i></button>
      </div>
    </div>
    <div id="mobileMenu" class="md:hidden hidden border-t border-slate-200 px-4 py-3 dark:border-slate-800">
      <div class="relative mb-3">
        <input id="searchInputMobile" type="search" placeholder="Search news, topics…" class="w-full rounded-xl border border-slate-200 bg-white/70 py-2 pl-9 pr-3 text-sm outline-none placeholder:text-slate-400 focus:border-brand-500 focus:ring-2 focus:ring-brand-500/30 dark:border-slate-700 dark:bg-slate-800" />
        <i class="fa-solid fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
      </div>
      <nav class="flex flex-wrap gap-4 text-sm">
        <a class="hover:text-brand-600" href="#/latest" data-route="latest">Latest</a>
        <a class="hover:text-brand-600" href="#/ai" data-route="ai">AI</a>
        <a class="hover:text-brand-600" href="#/mobile" data-route="mobile">Mobile</a>
        <a class="hover:text-brand-600" href="#/security" data-route="security">Security</a>
        <a class="hover:text-brand-600" href="#/reviews" data-route="reviews">Reviews</a>
      </nav>
    </div>
  </header>

  <!-- Main -->
  <main id="content" class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-16">
    <!-- Hero / Featured -->
    <section id="latest" class="grid grid-cols-1 lg:grid-cols-3 gap-6 pt-6">
      <article class="relative lg:col-span-2 overflow-hidden rounded-2xl bg-slate-100 dark:bg-slate-800 shadow-soft">
        <img id="featuredImage" class="h-72 w-full object-cover" alt="Featured story cover" loading="lazy" src="https://images.unsplash.com/photo-1518779578993-ec3579fee39f?q=80&w=1600&auto=format&fit=crop"/>
        <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
        <div class="absolute bottom-0 p-6 text-white space-y-2">
          <div class="flex items-center gap-2 text-xs opacity-90">
            <span class="inline-flex items-center gap-1 rounded-full bg-white/20 px-2 py-1 backdrop-blur"><i class="fa-solid fa-robot"></i> AI</span>
            <time id="featuredDate" class="opacity-90" datetime="">Just now</time>
            <span aria-hidden>•</span>
            <span id="featuredReadTime">5 min read</span>
          </div>
          <h2 id="featuredTitle" class="text-2xl sm:text-3xl font-extrabold leading-tight">Open models race accelerates as startups unveil multimodal breakthroughs</h2>
          <p id="featuredExcerpt" class="max-w-2xl text-sm sm:text-base opacity-95 line-clamp-2">From voice-native assistants to on-device inference, here are the launches that actually matter this week—and why.</p>
        </div>
        <button id="featuredOpen" class="absolute inset-0" aria-label="Open featured article"></button>
      </article>

      <!-- Side widgets -->
      <aside class="space-y-6">
        <!-- Categories -->
        <div class="rounded-2xl border border-slate-200 bg-white p-4 dark:border-slate-800 dark:bg-slate-900 shadow-soft">
          <h3 class="mb-3 text-sm font-semibold uppercase tracking-wide text-slate-500">Filter by topic</h3>
          <div id="categoryPills" class="flex flex-wrap gap-2"></div>
        </div>
        <!-- Newsletter -->
        <div class="rounded-2xl border border-slate-200 bg-white p-4 dark:border-slate-800 dark:bg-slate-900 shadow-soft">
          <h3 class="text-lg font-bold">Stay in the loop</h3>
          <p class="text-sm text-slate-500 dark:text-slate-400 mt-1">Weekly digest of the biggest tech stories, straight to your inbox.</p>
          <form class="mt-3 flex gap-2" onsubmit="event.preventDefault(); alert('Subscribed! (demo)')">
            <input type="email" required placeholder="you@domain.com" class="flex-1 rounded-xl border border-slate-200 bg-white/70 px-3 py-2 text-sm outline-none focus:border-brand-500 focus:ring-2 focus:ring-brand-500/30 dark:border-slate-700 dark:bg-slate-800" />
            <button class="rounded-xl bg-brand-600 px-4 py-2 text-sm font-semibold text-white hover:bg-brand-700">Subscribe</button>
          </form>
          <p class="mt-2 text-xs text-slate-500">No spam. Unsubscribe anytime.</p>
        </div>
      </aside>
    </section>

    <!-- Controls -->
    <section class="mt-8 flex flex-wrap items-center justify-between gap-3">
      <div class="flex items-center gap-2 text-sm">
        <label class="text-slate-500">Sort:</label>
        <select id="sortSelect" class="rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm dark:border-slate-700 dark:bg-slate-800">
          <option value="newest">Newest</option>
          <option value="popular">Most Popular</option>
          <option value="shortest">Shortest Read</option>
        </select>
      </div>
      <div class="text-xs text-slate-500" id="resultCount">Showing 0 results</div>
    </section>

    <!-- Section Title -->
    <h2 id="sectionTitle" class="mt-6 text-xl sm:text-2xl font-extrabold tracking-tight">Latest</h2>

    <!-- Articles Grid -->
    <section id="articles" class="mt-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></section>

    <!-- Infinite Scroll Sentinel -->
    <div id="sentinel" class="h-10"></div>

    <!-- Modal -->
    <div id="articleModal" class="fixed inset-0 z-50 hidden">
      <div class="absolute inset-0 bg-black/60" data-close></div>
      <div class="pointer-events-auto absolute left-1/2 top-1/2 w-[min(95vw,900px)] -translate-x-1/2 -translate-y-1/2 overflow-hidden rounded-2xl bg-white shadow-2xl dark:bg-slate-900">
        <div class="flex items-center justify-between border-b border-slate-200 p-4 dark:border-slate-800">
          <h3 id="modalTitle" class="text-lg font-bold">Article</h3>
          <button class="rounded-lg p-2 text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-800" data-close aria-label="Close"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-5 gap-0">
          <div class="lg:col-span-3 p-4">
            <img id="modalImage" alt="Article image" class="mb-4 h-56 w-full rounded-xl object-cover" loading="lazy"/>
            <div class="flex items-center gap-3 text-xs text-slate-500">
              <span id="modalMeta"></span>
              <a id="modalSource" target="_blank" rel="noopener" class="inline-flex items-center gap-1 text-brand-600 hover:underline">Source <i class="fa-solid fa-arrow-up-right-from-square text-[10px]"></i></a>
            </div>
            <p id="modalBody" class="mt-3 text-sm leading-relaxed text-slate-700 dark:text-slate-300"></p>
          </div>
          <aside class="lg:col-span-2 border-t lg:border-l lg:border-t-0 border-slate-200 p-4 dark:border-slate-800">
            <h4 class="mb-3 text-sm font-semibold uppercase tracking-wide text-slate-500">Related</h4>
            <ul id="relatedList" class="space-y-3 text-sm"></ul>
          </aside>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="border-t border-slate-200 bg-white/70 py-10 text-sm dark:border-slate-800 dark:bg-slate-900/70">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
      <div>
        <div class="flex items-center gap-2">
          <div class="h-8 w-8 rounded-lg bg-brand-600 text-white grid place-items-center"><i class="fa-solid fa-radar"></i></div>
          <span class="font-extrabold">TechStream</span>
        </div>
        <p class="mt-2 text-slate-500 dark:text-slate-400">Your daily dose of AI, gadgets, and the future—built as a demo page you can customize.</p>
      </div>
      <div>
        <h5 class="mb-2 font-semibold">Sections</h5>
        <ul class="space-y-1 text-slate-600 dark:text-slate-300">
          <li><a href="#ai" class="hover:text-brand-600">AI</a></li>
          <li><a href="#mobile" class="hover:text-brand-600">Mobile</a></li>
          <li><a href="#security" class="hover:text-brand-600">Security</a></li>
          <li><a href="#reviews" class="hover:text-brand-600">Reviews</a></li>
        </ul>
      </div>
      <div>
        <h5 class="mb-2 font-semibold">Company</h5>
        <ul class="space-y-1 text-slate-600 dark:text-slate-300">
          <li><a href="#" class="hover:text-brand-600">About</a></li>
          <li><a href="#" class="hover:text-brand-600">Advertise</a></li>
          <li><a href="#" class="hover:text-brand-600">Contact</a></li>
        </ul>
      </div>
      <div>
        <h5 class="mb-2 font-semibold">Follow</h5>
        <div class="flex gap-3 text-lg text-slate-500">
          <a href="#" aria-label="Twitter" class="hover:text-brand-600"><i class="fa-brands fa-x-twitter"></i></a>
          <a href="#" aria-label="YouTube" class="hover:text-brand-600"><i class="fa-brands fa-youtube"></i></a>
          <a href="#" aria-label="GitHub" class="hover:text-brand-600"><i class="fa-brands fa-github"></i></a>
        </div>
      </div>
    </div>
    <div class="mt-8 text-center text-xs text-slate-500">© <span id="year"></span> TechStream. Demo UI for a tech news page.</div>
  </footer>

  <!-- Data + JS -->
  <script>
    /**
     * Demo data to simulate articles from an API
     * Replace with real fetch("/api/news") later
     */
    const topics = ['All','AI','Mobile','Gadgets','Security','Software','Gaming','Science','Reviews'];

    const sample = (arr) => arr[Math.floor(Math.random()*arr.length)];

    function genArticles(start = 0, count = 12) {
      const sources = ['Wired','The Verge','TechCrunch','Ars Technica','The Information','Engadget','Tom\'s Hardware','Android Authority'];
      const thumbs = [
        'https://images.unsplash.com/photo-1518779578993-ec3579fee39f?q=80&w=1600&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1550751827-4bd374c3f58b?q=80&w=1600&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1518770660439-4636190af475?q=80&w=1600&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1498050108023-c5249f4df085?q=80&w=1600&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1498049794561-7780e7231661?q=80&w=1600&auto=format&fit=crop',
        'https://images.unsplash.com/photo-1518773553398-650c184e0bb3?q=80&w=1600&auto=format&fit=crop'
      ];
      const cats = topics.slice(1); // exclude All
      return Array.from({length: count}).map((_,i)=>{
        const id = start + i + 1;
        const category = sample(cats);
        const read = [3,4,5,6,7,8][Math.floor(Math.random()*6)];
        const minutesAgo = Math.floor(Math.random()*720); // within last 12h
        return {
          id,
          title: `${category}: ${['Breakthrough','Launch','Update','Leak','Report','Deep Dive'][Math.floor(Math.random()*6)]} #${id}`,
          excerpt: 'Short summary of the story with the key details. This demo text shows how the card will look in the grid.',
          image: sample(thumbs),
          source: sample(sources),
          url: '#',
          category,
          read,
          views: Math.floor(Math.random()*5000)+500,
          publishedAt: Date.now() - minutesAgo*60*1000
        };
      });
    }

    let allArticles = genArticles(0, 24);
    let loaded = 0;
    const pageSize = 9;

    const state = {
      query: '',
      category: 'All',
      sort: 'newest'
    };
    // Client-side router for section pages
    const routes = {
      latest: { label: 'Latest', category: 'All' },
      ai: { label: 'AI', category: 'AI' },
      mobile: { label: 'Mobile', category: 'Mobile' },
      security: { label: 'Security', category: 'Security' },
      reviews: { label: 'Reviews', category: 'Reviews' }
    };

    function applyRoute() {
      const hash = (location.hash || '#/latest').toLowerCase();
      const key = hash.replace('#/','');
      const route = routes[key] || routes.latest;
      state.category = route.category;
      loaded = 0;
      updateActiveNav(key);
      const titleEl = document.getElementById('sectionTitle');
      if (titleEl) titleEl.textContent = route.label;
      document.title = `${route.label} — TechStream`;
      render(true);
      // Scroll to top of content for "page" feel
      document.getElementById('content')?.scrollIntoView({behavior: 'smooth', block: 'start'});
    }

    function updateActiveNav(activeKey){
      document.querySelectorAll('[data-route]').forEach(a=>{
        if(a.getAttribute('data-route') === activeKey){
          a.classList.add('text-brand-600','font-semibold');
        } else {
          a.classList.remove('text-brand-600','font-semibold');
        }
      });
      highlightActivePill(state.category === 'All' ? 'All' : state.category);
    }

    window.addEventListener('hashchange', applyRoute);

    // Elements
    const articlesEl = document.getElementById('articles');
    const resultCountEl = document.getElementById('resultCount');
    const sortSelect = document.getElementById('sortSelect');
    const searchInput = document.getElementById('searchInput');
    const searchInputMobile = document.getElementById('searchInputMobile');
    const sentinel = document.getElementById('sentinel');

    // Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Theme toggle with localStorage
    const themeToggle = document.getElementById('themeToggle');
    const root = document.documentElement;
    const setTheme = (mode) => {
      if (mode === 'dark') root.classList.add('dark'); else root.classList.remove('dark');
      localStorage.setItem('theme', mode);
      themeToggle.innerHTML = mode === 'dark' ? '<i class="fa-solid fa-sun"></i>' : '<i class="fa-solid fa-moon"></i>';
    };
    setTheme(localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'));
    themeToggle.addEventListener('click',()=> setTheme(root.classList.contains('dark') ? 'light' : 'dark'));

    // Mobile menu toggle
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    mobileMenuBtn.addEventListener('click', ()=>{
      const open = mobileMenu.classList.toggle('hidden');
      mobileMenuBtn.setAttribute('aria-expanded', String(!open));
    });

    // Build category pills
    const categoryPills = document.getElementById('categoryPills');
    topics.forEach(t=>{
      const btn = document.createElement('button');
      btn.className = 'px-3 py-1.5 rounded-full text-sm border border-slate-200 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800';
      btn.textContent = t;
      btn.dataset.value = t;
      btn.addEventListener('click',()=>{ state.category = t; loaded = 0; render(true); highlightActivePill(t); });
      categoryPills.appendChild(btn);
    });

    function highlightActivePill(val){
      [...categoryPills.children].forEach(el=>{
        if(el.dataset.value === val){ el.classList.add('bg-brand-600','text-white','border-brand-600'); }
        else { el.classList.remove('bg-brand-600','text-white','border-brand-600'); }
      });
    }
    highlightActivePill('All');

    // Search
    function onSearch(e){ state.query = e.target.value.toLowerCase(); loaded = 0; render(true); }
    searchInput?.addEventListener('input', onSearch);
    searchInputMobile?.addEventListener('input', onSearch);

    // Sort
    sortSelect.addEventListener('change',()=>{ state.sort = sortSelect.value; loaded = 0; render(true); });

    // Ticker
    const tickerData = [
      'Apple\'s R1 chip rumored to boost on-device AI',
      'Open-source LLMs inch closer to GPT-4 class',
      'Linux kernel gets major scheduler revamp',
      'Wi‑Fi 7 routers hit mainstream pricing',
      'USB‑C certification crackdown rolls out',
    ];
    const tickerTrack = document.getElementById('ticker-track');
    function buildTicker(){
      tickerTrack.innerHTML = '';
      const row = document.createElement('div');
      row.className = 'animate-marquee inline-block';
      row.style.animation = 'marquee 30s linear infinite';
      row.innerHTML = tickerData.map(t=>`<span class=\"mx-6 inline-flex items-center gap-2 text-slate-600 dark:text-slate-300\"><i class=\"fa-solid fa-circle text-[6px]\"></i> ${t}</span>`).join('');
      tickerTrack.appendChild(row);
    }
    buildTicker();
    const style = document.createElement('style');
    style.textContent = '@keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }';
    document.head.appendChild(style);

    // Render
    function formatTime(ts){
      const diff = Math.max(1, Math.floor((Date.now()-ts)/60000));
      if(diff < 60) return `${diff} min ago`;
      const h = Math.floor(diff/60); if(h<24) return `${h} hr${h>1?'s':''} ago`;
      const d = Math.floor(h/24); return `${d} day${d>1?'s':''} ago`;
    }

    function applyFilters(list){
      return list.filter(a => (state.category==='All' || a.category===state.category) &&
        (state.query==='' || a.title.toLowerCase().includes(state.query) || a.excerpt.toLowerCase().includes(state.query)));
    }

    function applySort(list){
      const arr = [...list];
      if(state.sort==='newest') arr.sort((a,b)=>b.publishedAt - a.publishedAt);
      if(state.sort==='popular') arr.sort((a,b)=>b.views - a.views);
      if(state.sort==='shortest') arr.sort((a,b)=>a.read - b.read);
      return arr;
    }

    function createCard(a){
      const el = document.createElement('article');
      el.className = 'group overflow-hidden rounded-2xl border border-slate-200 bg-white dark:border-slate-800 dark:bg-slate-900 hover:shadow-xl transition-shadow shadow-soft';
      el.innerHTML = `
        <div class=\"relative\">
          <img alt=\"${a.title}\" src=\"${a.image}\" class=\"h-44 w-full object-cover transition-transform duration-300 group-hover:scale-[1.02]\" loading=\"lazy\"/>
          <span class=\"absolute left-3 top-3 rounded-full bg-black/60 px-2 py-1 text-xs text-white backdrop-blur\"><i class=\"fa-solid fa-tag\"></i> ${a.category}</span>
        </div>
        <div class=\"p-4 space-y-2\">
          <h3 class=\"text-lg font-bold leading-snug line-clamp-2\">${a.title}</h3>
          <p class=\"text-sm text-slate-600 dark:text-slate-300 line-clamp-3\">${a.excerpt}</p>
          <div class=\"flex items-center justify-between text-xs text-slate-500\">
            <span>${a.source}</span>
            <span>${formatTime(a.publishedAt)} • ${a.read} min</span>
          </div>
        </div>`;
      el.addEventListener('click', ()=> openModal(a));
      return el;
    }

    function openModal(a){
      document.getElementById('modalTitle').textContent = a.title;
      const meta = `${a.source} • ${formatTime(a.publishedAt)} • ${a.read} min read`;
      document.getElementById('modalMeta').textContent = meta;
      document.getElementById('modalImage').src = a.image;
      document.getElementById('modalBody').textContent = `${a.excerpt} This is a demo modal. Link out to the full article for details.`;
      const relatedRoot = document.getElementById('relatedList');
      relatedRoot.innerHTML = '';
      applyFilters(allArticles.filter(x=>x.category===a.category && x.id!==a.id)).slice(0,5).forEach(r=>{
        const li = document.createElement('li');
        li.innerHTML = `<a class=\"hover:underline\" href=\"#\">${r.title}</a>`;
        relatedRoot.appendChild(li);
      });
      const modal = document.getElementById('articleModal');
      modal.classList.remove('hidden');
      modal.querySelectorAll('[data-close]').forEach(b=> b.addEventListener('click', ()=> modal.classList.add('hidden')));
    }

    // Featured binds
    document.getElementById('featuredOpen').addEventListener('click', ()=> openModal(allArticles[0]));

    function render(reset=false){
      const filtered = applySort(applyFilters(allArticles));
      resultCountEl.textContent = `Showing ${filtered.length} results`;

      if(reset){ articlesEl.innerHTML = ''; loaded = 0; }

      const batch = filtered.slice(loaded, loaded + pageSize);
      batch.forEach(a=> articlesEl.appendChild(createCard(a)));
      loaded += batch.length;

      // update featured from first filtered
      if(filtered[0]){
        const f = filtered[0];
        document.getElementById('featuredTitle').textContent = f.title;
        document.getElementById('featuredExcerpt').textContent = f.excerpt;
        document.getElementById('featuredImage').src = f.image;
        document.getElementById('featuredDate').textContent = formatTime(f.publishedAt);
        document.getElementById('featuredReadTime').textContent = `${f.read} min read`;
      }
    }

    // Infinite scroll using IntersectionObserver
    const io = new IntersectionObserver((entries)=>{
      if(entries[0].isIntersecting){
        const filtered = applySort(applyFilters(allArticles));
        if(loaded < filtered.length){
          render(false);
        } else {
          // simulate loading more from API
          const more = genArticles(allArticles.length, 12);
          allArticles = allArticles.concat(more);
          render(false);
        }
      }
    }, {rootMargin: '200px'});
    io.observe(sentinel);

    // Initial render via route
    applyRoute();
  </script>
</body>
</html>
